{% extends "base.html" %}
{% block title %}{{ post['title'] }}{% endblock %}
{% block BodyContent %}
<div class="container">
    <h1>{{ post['title'] }}</h1>
    <h3><small>Posted by {{ post['username']}}</small></h3>
    <p>{{ post['content'] }}</p>
    {% if session['username'] == post['username'] %}
    <a href="{{ url_for('edit_post', post_id=post['_id']) }}" class="btn btn-warning">Edit</a>
    <a href="{{ url_for('delete_post', post_id=post['_id']) }}" class="btn btn-danger">Delete</a>
    {% endif %}

    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="container mt-3">
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    </div>
    {% endif %}
    {% endwith %}


    <h3>Comments</h3>
    <form method="POST" action="{{ url_for('comment', post_id=post['_id']) }}">
        <div class="form-group">
            <textarea name="content" class="form-control" required></textarea>
        </div>
        <button type="submit" class="btn btn-primary mt-2">Add Comment</button>
    </form>

    <ul class="list-group mt-4">
        {% for comment in comments %}
        <li class="list-group-item">{{ comment['content'] }}</li>
        {% endfor %}
    </ul>
</div>
{% endblock %}